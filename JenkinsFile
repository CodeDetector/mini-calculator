pipeline {
	agent any 
	
	stages {
		stage('checkout'){
			checkout scm
		}
		stage('Maven Build'){
			sh 'mvn clean install'
		}
		stage('Docker Build Image'){
			sh 'docker build -t dhruvsharma983/docker-push .'
		}
		stage('Publish Docker Images'){
		withCredentials([usernamePassword(credentialsId:'dockerCreds',usernameVariable:'USERNAME',passwordVariable:'PASSWORD')]){
		sh "docker login -u ${env.USERNAME} -p ${env.PASSWORD}"
		sh "docker push dhruvsharma983/docker-push:latest"
		}
		}
	}

}
